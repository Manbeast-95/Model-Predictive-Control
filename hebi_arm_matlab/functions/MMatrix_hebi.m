function Mq = MMatrix(m, COM, I, y, z, L1, theta)

theta1 = theta(1);
theta2 = theta(2);
theta3 = theta(3);
theta4 = theta(4);
theta5 = 0;

%%
m1 = m{1}; m2 = m{2}; m3 = m{3}; m4 = m{4}; m5 = m{5};
COM1x = COM{1}{1}; COM1y = COM{1}{2}; COM1z = COM{1}{3};
COM2x = COM{2}{1}; COM2y = COM{2}{2}; COM2z = COM{2}{3};
COM3x = COM{3}{1}; COM3y = COM{3}{2}; COM3z = COM{3}{3};
COM4x = COM{4}{1}; COM4y = COM{4}{2}; COM4z = COM{4}{3};
COM5x = COM{5}{1}; COM5y = COM{5}{2}; COM5z = COM{5}{3};

y0 = y{1}; y1 = y{2}; y2 = y{3}; y3 = y{4}; y4 = y{5};
z0 = z{1}; z1 = z{2}; z2 =  z{3}; z3 = z{4}; z4 = z{5};

Ixx1 = I{1}{1}; Ixx2 = I{1}{2}; Ixx3 = I{1}{3}; Ixx4 = I{1}{4}; Ixx5 = I{1}{5};
Iyy1 = I{2}{1}; Iyy2 = I{2}{2}; Iyy3 = I{2}{3}; Iyy4 = I{2}{4}; Iyy5 = I{2}{5};
Izz1 = I{3}{1}; Izz2 = I{3}{2}; Izz3 = I{3}{3}; Izz4 = I{3}{4}; Izz5 = I{3}{5};
Ixy1 = I{4}{1}; Ixy2 = I{4}{2}; Ixy3 = I{4}{3}; Ixy4 = I{4}{4}; Ixy5 = I{4}{5};
Iyz1 = I{5}{1}; Iyz2 = I{5}{2}; Iyz3 = I{5}{3}; Iyz4 = I{5}{4}; Iyz5 = I{5}{5};
Ixz1 = I{6}{1}; Ixz2 = I{6}{2}; Ixz3 = I{6}{3}; Ixz4 = I{6}{4}; Ixz5 = I{6}{5};

%%
Mq = [Izz1+m2.*(COM2y+y1).^2.*cos(theta2).^2+m3.*(COM3y+y1+y2).^2.*cos( ...
  theta2+(-1).*theta3).^2+m4.*(COM4y+y1+y2+y3).^2.*cos(theta2+(-1).* ...
  theta3+theta4).^2+m1.*(sin(theta1).*(COM1y.*cos(theta1)+COM1x.*sin( ...
  theta1))+(-1).*cos(theta1).*((-1).*COM1x.*cos(theta1)+COM1y.*sin(theta1) ...
  )).^2+m1.*((-1).*cos(theta1).*(COM1y.*cos(theta1)+COM1x.*sin(theta1))+( ...
  -1).*sin(theta1).*((-1).*COM1x.*cos(theta1)+COM1y.*sin(theta1))).^2+m2.* ...
  (COM2y+y1).^2.*sin(theta2).^2+sin(theta2).*(Ixz2.*cos(theta2)+Ixx2.*sin( ...
  theta2))+cos(theta2).*(Izz2.*cos(theta2)+Ixz2.*sin(theta2))+m2.*(COM2x.* ...
  cos(theta2)+(-1).*(COM2z+z0).*sin(theta2)).^2+m3.*(COM3y+y1+y2).^2.*sin( ...
  theta2+(-1).*theta3).^2+sin(theta2+(-1).*theta3).*(Ixz3.*cos(theta2+(-1) ...
  .*theta3)+Ixx3.*sin(theta2+(-1).*theta3))+cos(theta2+(-1).*theta3).*( ...
  Izz3.*cos(theta2+(-1).*theta3)+Ixz3.*sin(theta2+(-1).*theta3))+m3.*( ...
  COM3x.*cos(theta2+(-1).*theta3)+(-1).*L1.*sin(theta2)+(-1).*(COM3z+(-1) ...
  .*L1+z0+z2).*sin(theta2+(-1).*theta3)).^2+m4.*(COM4y+y1+y2+y3).^2.*sin( ...
  theta2+(-1).*theta3+theta4).^2+sin(theta2+(-1).*theta3+theta4).*(Ixz4.* ...
  cos(theta2+(-1).*theta3+theta4)+Ixx4.*sin(theta2+(-1).*theta3+theta4))+ ...
  cos(theta2+(-1).*theta3+theta4).*(Izz4.*cos(theta2+(-1).*theta3+theta4)+ ...
  Ixz4.*sin(theta2+(-1).*theta3+theta4))+m4.*(COM4x.*cos(theta2+(-1).* ...
  theta3+theta4)+(-1).*L1.*sin(theta2)+(-1).*L1.*sin(theta2+(-1).*theta3)+ ...
  (-1).*COM4z.*sin(theta2+(-1).*theta3+theta4)+2.*L1.*sin(theta2+(-1).* ...
  theta3+theta4)+(-1).*z0.*sin(theta2+(-1).*theta3+theta4)+(-1).*z2.*sin( ...
  theta2+(-1).*theta3+theta4)+(-1).*z3.*sin(theta2+(-1).*theta3+theta4)) ...
  .^2+m5.*sin(theta2+(-1).*theta3+theta4).^2.*(y4+(COM5y+y1+y2+y3).*cos( ...
  theta5)+COM5x.*sin(theta5)).^2+cos(theta5).*sin(theta2+(-1).*theta3+ ...
  theta4).*(Ixz5.*cos(theta2+(-1).*theta3+theta4)+Ixx5.*cos(theta5).*sin( ...
  theta2+(-1).*theta3+theta4)+(-1).*Ixy5.*sin(theta2+(-1).*theta3+theta4) ...
  .*sin(theta5))+(-1).*sin(theta2+(-1).*theta3+theta4).*sin(theta5).*( ...
  Iyz5.*cos(theta2+(-1).*theta3+theta4)+Ixy5.*cos(theta5).*sin(theta2+(-1) ...
  .*theta3+theta4)+(-1).*Iyy5.*sin(theta2+(-1).*theta3+theta4).*sin( ...
  theta5))+cos(theta2+(-1).*theta3+theta4).*(Izz5.*cos(theta2+(-1).* ...
  theta3+theta4)+Ixz5.*cos(theta5).*sin(theta2+(-1).*theta3+theta4)+(-1).* ...
  Iyz5.*sin(theta2+(-1).*theta3+theta4).*sin(theta5))+m5.*((-1).*cos( ...
  theta5).*(L1.*sin(theta2)+L1.*sin(theta2+(-1).*theta3)+(COM5z+(-2).*L1+ ...
  z0+z2+z3+z4).*sin(theta2+(-1).*theta3+theta4))+cos(theta2+(-1).*theta3+ ...
  theta4).*(COM5x+y4.*sin(theta5))).^2+m5.*((-1).*(cos(theta2+(-1).* ...
  theta3+theta4).*cos(theta5).*sin(theta1)+cos(theta1).*sin(theta5)).*( ...
  sin(theta1).*(y4+(COM5y+y1+y2+y3).*cos(theta5)+COM5x.*sin(theta5))+(-1) ...
  .*cos(theta1).*((-1).*L1.*(sin(theta2)+sin(theta2+(-1).*theta3))+(-1).*( ...
  COM5z+(-2).*L1+z0+z2+z3+z4).*sin(theta2+(-1).*theta3+theta4)+cos(theta2+ ...
  (-1).*theta3+theta4).*(COM5x.*cos(theta5)+(-1).*(COM5y+y1+y2+y3).*sin( ...
  theta5))))+(-1).*(cos(theta1).*cos(theta2+(-1).*theta3+theta4).*cos( ...
  theta5)+(-1).*sin(theta1).*sin(theta5)).*(cos(theta1).*(y4+(COM5y+y1+y2+ ...
  y3).*cos(theta5)+COM5x.*sin(theta5))+sin(theta1).*((-1).*L1.*(sin( ...
  theta2)+sin(theta2+(-1).*theta3))+(-1).*(COM5z+(-2).*L1+z0+z2+z3+z4).* ...
  sin(theta2+(-1).*theta3+theta4)+cos(theta2+(-1).*theta3+theta4).*( ...
  COM5x.*cos(theta5)+(-1).*(COM5y+y1+y2+y3).*sin(theta5))))).^2,(-1).* ...
  Iyz2.*cos(theta2)+(-1).*m2.*(COM2y+y1).*((-1).*COM2z+(-1).*z0).*cos( ...
  theta2)+(-1).*Iyz3.*cos(theta2+(-1).*theta3)+(-1).*m3.*(COM3y+y1+y2).* ...
  cos(theta2+(-1).*theta3).*((-1).*COM3z+L1+(-1).*z0+(-1).*z2+(-1).*L1.* ...
  cos(theta3))+(-1).*Iyz4.*cos(theta2+(-1).*theta3+theta4)+(-1).*m4.*( ...
  COM4y+y1+y2+y3).*((-1).*COM4z+2.*L1+(-1).*z0+(-1).*z2+(-1).*z3+(-1).* ...
  L1.*cos(theta3+(-1).*theta4)+(-1).*L1.*cos(theta4)).*cos(theta2+(-1).* ...
  theta3+theta4)+(-1).*Ixy2.*sin(theta2)+COM2x.*m2.*(COM2y+y1).*sin( ...
  theta2)+(-1).*Ixy3.*sin(theta2+(-1).*theta3)+m3.*(COM3y+y1+y2).*sin( ...
  theta2+(-1).*theta3).*(COM3x+(-1).*L1.*sin(theta3))+(-1).*Ixy4.*sin( ...
  theta2+(-1).*theta3+theta4)+m4.*(COM4y+y1+y2+y3).*(COM4x+(-1).*L1.*sin( ...
  theta3+(-1).*theta4)+L1.*sin(theta4)).*sin(theta2+(-1).*theta3+theta4)+ ...
  m5.*sin(theta2+(-1).*theta3+theta4).*(y4+(COM5y+y1+y2+y3).*cos(theta5)+ ...
  COM5x.*sin(theta5)).*(COM5x.*cos(theta5)+(-1).*L1.*sin(theta3+(-1).* ...
  theta4)+L1.*sin(theta4)+(-1).*COM5y.*sin(theta5)+(-1).*y1.*sin(theta5)+( ...
  -1).*y2.*sin(theta5)+(-1).*y3.*sin(theta5))+(-1).*sin(theta5).*(Ixz5.* ...
  cos(theta2+(-1).*theta3+theta4)+Ixx5.*cos(theta5).*sin(theta2+(-1).* ...
  theta3+theta4)+(-1).*Ixy5.*sin(theta2+(-1).*theta3+theta4).*sin(theta5))+...
  (-1).*cos(theta5).*(Iyz5.*cos(theta2+(-1).*theta3+theta4)+Ixy5.*cos( ...
  theta5).*sin(theta2+(-1).*theta3+theta4)+(-1).*Iyy5.*sin(theta2+(-1).* ...
  theta3+theta4).*sin(theta5))+m5.*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos( ...
  theta3+(-1).*theta4)+L1.*cos(theta4)).*sin(theta5).*((-1).*cos(theta5).* ...
  (L1.*sin(theta2)+L1.*sin(theta2+(-1).*theta3)+(COM5z+(-2).*L1+z0+z2+z3+ ...
  z4).*sin(theta2+(-1).*theta3+theta4))+cos(theta2+(-1).*theta3+theta4).*( ...
  COM5x+y4.*sin(theta5)))+(-1).*m5.*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos( ...
  theta3+(-1).*theta4)+L1.*cos(theta4)).*cos(theta5).*((-1).*(cos(theta2+( ...
  -1).*theta3+theta4).*cos(theta5).*sin(theta1)+cos(theta1).*sin(theta5)) ...
  .*(sin(theta1).*(y4+(COM5y+y1+y2+y3).*cos(theta5)+COM5x.*sin(theta5))+( ...
  -1).*cos(theta1).*((-1).*L1.*(sin(theta2)+sin(theta2+(-1).*theta3))+(-1) ...
  .*(COM5z+(-2).*L1+z0+z2+z3+z4).*sin(theta2+(-1).*theta3+theta4)+cos( ...
  theta2+(-1).*theta3+theta4).*(COM5x.*cos(theta5)+(-1).*(COM5y+y1+y2+y3) ...
  .*sin(theta5))))+(-1).*(cos(theta1).*cos(theta2+(-1).*theta3+theta4).* ...
  cos(theta5)+(-1).*sin(theta1).*sin(theta5)).*(cos(theta1).*(y4+(COM5y+ ...
  y1+y2+y3).*cos(theta5)+COM5x.*sin(theta5))+sin(theta1).*((-1).*L1.*(sin( ...
  theta2)+sin(theta2+(-1).*theta3))+(-1).*(COM5z+(-2).*L1+z0+z2+z3+z4).* ...
  sin(theta2+(-1).*theta3+theta4)+cos(theta2+(-1).*theta3+theta4).*( ...
  COM5x.*cos(theta5)+(-1).*(COM5y+y1+y2+y3).*sin(theta5))))),Iyz3.*cos( ...
  theta2+(-1).*theta3)+(-1).*m3.*(COM3y+y1+y2).*(COM3z+(-1).*L1+z0+z2).* ...
  cos(theta2+(-1).*theta3)+Iyz4.*cos(theta2+(-1).*theta3+theta4)+(-1).* ...
  m4.*(COM4y+y1+y2+y3).*(COM4z+(-2).*L1+z0+z2+z3+L1.*cos(theta4)).*cos( ...
  theta2+(-1).*theta3+theta4)+Ixy3.*sin(theta2+(-1).*theta3)+(-1).*COM3x.* ...
  m3.*(COM3y+y1+y2).*sin(theta2+(-1).*theta3)+Ixy4.*sin(theta2+(-1).* ...
  theta3+theta4)+m4.*(COM4y+y1+y2+y3).*((-1).*COM4x+(-1).*L1.*sin(theta4)) ...
  .*sin(theta2+(-1).*theta3+theta4)+m5.*sin(theta2+(-1).*theta3+theta4).*( ...
  y4+(COM5y+y1+y2+y3).*cos(theta5)+COM5x.*sin(theta5)).*((-1).*COM5x.*cos( ...
  theta5)+(-1).*L1.*sin(theta4)+(COM5y+y1+y2+y3).*sin(theta5))+sin(theta5) ...
  .*(Ixz5.*cos(theta2+(-1).*theta3+theta4)+Ixx5.*cos(theta5).*sin(theta2+( ...
  -1).*theta3+theta4)+(-1).*Ixy5.*sin(theta2+(-1).*theta3+theta4).*sin( ...
  theta5))+cos(theta5).*(Iyz5.*cos(theta2+(-1).*theta3+theta4)+Ixy5.*cos( ...
  theta5).*sin(theta2+(-1).*theta3+theta4)+(-1).*Iyy5.*sin(theta2+(-1).* ...
  theta3+theta4).*sin(theta5))+(-1).*m5.*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.* ...
  cos(theta4)).*sin(theta5).*((-1).*cos(theta5).*(L1.*sin(theta2)+L1.*sin( ...
  theta2+(-1).*theta3)+(COM5z+(-2).*L1+z0+z2+z3+z4).*sin(theta2+(-1).* ...
  theta3+theta4))+cos(theta2+(-1).*theta3+theta4).*(COM5x+y4.*sin(theta5)) ...
  )+m5.*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos(theta4)).*cos(theta5).*((-1).* ...
  (cos(theta2+(-1).*theta3+theta4).*cos(theta5).*sin(theta1)+cos(theta1).* ...
  sin(theta5)).*(sin(theta1).*(y4+(COM5y+y1+y2+y3).*cos(theta5)+COM5x.* ...
  sin(theta5))+(-1).*cos(theta1).*((-1).*L1.*(sin(theta2)+sin(theta2+(-1) ...
  .*theta3))+(-1).*(COM5z+(-2).*L1+z0+z2+z3+z4).*sin(theta2+(-1).*theta3+ ...
  theta4)+cos(theta2+(-1).*theta3+theta4).*(COM5x.*cos(theta5)+(-1).*( ...
  COM5y+y1+y2+y3).*sin(theta5))))+(-1).*(cos(theta1).*cos(theta2+(-1).* ...
  theta3+theta4).*cos(theta5)+(-1).*sin(theta1).*sin(theta5)).*(cos( ...
  theta1).*(y4+(COM5y+y1+y2+y3).*cos(theta5)+COM5x.*sin(theta5))+sin( ...
  theta1).*((-1).*L1.*(sin(theta2)+sin(theta2+(-1).*theta3))+(-1).*(COM5z+ ...
  (-2).*L1+z0+z2+z3+z4).*sin(theta2+(-1).*theta3+theta4)+cos(theta2+(-1).* ...
  theta3+theta4).*(COM5x.*cos(theta5)+(-1).*(COM5y+y1+y2+y3).*sin(theta5)) ...
  ))),(-1).*Iyz4.*cos(theta2+(-1).*theta3+theta4)+(-1).*m4.*(COM4y+y1+y2+ ...
  y3).*((-1).*COM4z+2.*L1+(-1).*z0+(-1).*z2+(-1).*z3).*cos(theta2+(-1).* ...
  theta3+theta4)+(-1).*Ixy4.*sin(theta2+(-1).*theta3+theta4)+COM4x.*m4.*( ...
  COM4y+y1+y2+y3).*sin(theta2+(-1).*theta3+theta4)+m5.*sin(theta2+(-1).* ...
  theta3+theta4).*(y4+(COM5y+y1+y2+y3).*cos(theta5)+COM5x.*sin(theta5)).*( ...
  COM5x.*cos(theta5)+(-1).*(COM5y+y1+y2+y3).*sin(theta5))+(-1).*sin( ...
  theta5).*(Ixz5.*cos(theta2+(-1).*theta3+theta4)+Ixx5.*cos(theta5).*sin( ...
  theta2+(-1).*theta3+theta4)+(-1).*Ixy5.*sin(theta2+(-1).*theta3+theta4) ...
  .*sin(theta5))+(-1).*cos(theta5).*(Iyz5.*cos(theta2+(-1).*theta3+theta4) ...
  +Ixy5.*cos(theta5).*sin(theta2+(-1).*theta3+theta4)+(-1).*Iyy5.*sin( ...
  theta2+(-1).*theta3+theta4).*sin(theta5))+m5.*(COM5z+(-2).*L1+z0+z2+z3+ ...
  z4).*sin(theta5).*((-1).*cos(theta5).*(L1.*sin(theta2)+L1.*sin(theta2+( ...
  -1).*theta3)+(COM5z+(-2).*L1+z0+z2+z3+z4).*sin(theta2+(-1).*theta3+ ...
  theta4))+cos(theta2+(-1).*theta3+theta4).*(COM5x+y4.*sin(theta5)))+(-1) ...
  .*m5.*(COM5z+(-2).*L1+z0+z2+z3+z4).*cos(theta5).*((-1).*(cos(theta2+(-1) ...
  .*theta3+theta4).*cos(theta5).*sin(theta1)+cos(theta1).*sin(theta5)).*( ...
  sin(theta1).*(y4+(COM5y+y1+y2+y3).*cos(theta5)+COM5x.*sin(theta5))+(-1) ...
  .*cos(theta1).*((-1).*L1.*(sin(theta2)+sin(theta2+(-1).*theta3))+(-1).*( ...
  COM5z+(-2).*L1+z0+z2+z3+z4).*sin(theta2+(-1).*theta3+theta4)+cos(theta2+ ...
  (-1).*theta3+theta4).*(COM5x.*cos(theta5)+(-1).*(COM5y+y1+y2+y3).*sin( ...
  theta5))))+(-1).*(cos(theta1).*cos(theta2+(-1).*theta3+theta4).*cos( ...
  theta5)+(-1).*sin(theta1).*sin(theta5)).*(cos(theta1).*(y4+(COM5y+y1+y2+ ...
  y3).*cos(theta5)+COM5x.*sin(theta5))+sin(theta1).*((-1).*L1.*(sin( ...
  theta2)+sin(theta2+(-1).*theta3))+(-1).*(COM5z+(-2).*L1+z0+z2+z3+z4).* ...
  sin(theta2+(-1).*theta3+theta4)+cos(theta2+(-1).*theta3+theta4).*( ...
  COM5x.*cos(theta5)+(-1).*(COM5y+y1+y2+y3).*sin(theta5))))),Izz5.*cos( ...
  theta2+(-1).*theta3+theta4)+Ixz5.*cos(theta5).*sin(theta2+(-1).*theta3+ ...
  theta4)+(-1).*Iyz5.*sin(theta2+(-1).*theta3+theta4).*sin(theta5)+COM5x.* ...
  m5.*((-1).*cos(theta5).*(L1.*sin(theta2)+L1.*sin(theta2+(-1).*theta3)+( ...
  COM5z+(-2).*L1+z0+z2+z3+z4).*sin(theta2+(-1).*theta3+theta4))+cos( ...
  theta2+(-1).*theta3+theta4).*(COM5x+y4.*sin(theta5)))+m5.*((-1).*COM5y+( ...
  -1).*y1+(-1).*y2+(-1).*y3).*((-1).*(cos(theta2+(-1).*theta3+theta4).* ...
  cos(theta5).*sin(theta1)+cos(theta1).*sin(theta5)).*(sin(theta1).*(y4+( ...
  COM5y+y1+y2+y3).*cos(theta5)+COM5x.*sin(theta5))+(-1).*cos(theta1).*(( ...
  -1).*L1.*(sin(theta2)+sin(theta2+(-1).*theta3))+(-1).*(COM5z+(-2).*L1+ ...
  z0+z2+z3+z4).*sin(theta2+(-1).*theta3+theta4)+cos(theta2+(-1).*theta3+ ...
  theta4).*(COM5x.*cos(theta5)+(-1).*(COM5y+y1+y2+y3).*sin(theta5))))+(-1) ...
  .*(cos(theta1).*cos(theta2+(-1).*theta3+theta4).*cos(theta5)+(-1).*sin( ...
  theta1).*sin(theta5)).*(cos(theta1).*(y4+(COM5y+y1+y2+y3).*cos(theta5)+ ...
  COM5x.*sin(theta5))+sin(theta1).*((-1).*L1.*(sin(theta2)+sin(theta2+(-1) ...
  .*theta3))+(-1).*(COM5z+(-2).*L1+z0+z2+z3+z4).*sin(theta2+(-1).*theta3+ ...
  theta4)+cos(theta2+(-1).*theta3+theta4).*(COM5x.*cos(theta5)+(-1).*( ...
  COM5y+y1+y2+y3).*sin(theta5)))));...
  (-1).*Iyz2.*cos(theta2)+(-1).*m2.*( ...
  COM2y+y1).*((-1).*COM2z+(-1).*z0).*cos(theta2)+(-1).*Iyz3.*cos(theta2+( ...
  -1).*theta3)+(-1).*m3.*(COM3y+y1+y2).*cos(theta2+(-1).*theta3).*((-1).* ...
  COM3z+L1+(-1).*z0+(-1).*z2+(-1).*L1.*cos(theta3))+(-1).*Iyz4.*cos( ...
  theta2+(-1).*theta3+theta4)+(-1).*m4.*(COM4y+y1+y2+y3).*((-1).*COM4z+2.* ...
  L1+(-1).*z0+(-1).*z2+(-1).*z3+(-1).*L1.*cos(theta3+(-1).*theta4)+(-1).* ...
  L1.*cos(theta4)).*cos(theta2+(-1).*theta3+theta4)+(-1).*Ixy2.*sin( ...
  theta2)+COM2x.*m2.*(COM2y+y1).*sin(theta2)+(-1).*Ixy3.*sin(theta2+(-1).* ...
  theta3)+m3.*(COM3y+y1+y2).*sin(theta2+(-1).*theta3).*(COM3x+(-1).*L1.* ...
  sin(theta3))+(-1).*Ixy4.*sin(theta2+(-1).*theta3+theta4)+m4.*(COM4y+y1+ ...
  y2+y3).*(COM4x+(-1).*L1.*sin(theta3+(-1).*theta4)+L1.*sin(theta4)).*sin( ...
  theta2+(-1).*theta3+theta4)+cos(theta5).*sin(theta2+(-1).*theta3+theta4) ...
  .*((-1).*Ixy5.*cos(theta5)+(-1).*Ixx5.*sin(theta5))+(-1).*sin(theta2+( ...
  -1).*theta3+theta4).*sin(theta5).*((-1).*Iyy5.*cos(theta5)+(-1).*Ixy5.* ...
  sin(theta5))+cos(theta2+(-1).*theta3+theta4).*((-1).*Iyz5.*cos(theta5)+( ...
  -1).*Ixz5.*sin(theta5))+m5.*sin(theta2+(-1).*theta3+theta4).*(y4+(COM5y+ ...
  y1+y2+y3).*cos(theta5)+COM5x.*sin(theta5)).*(COM5x.*cos(theta5)+(-1).* ...
  L1.*sin(theta3+(-1).*theta4)+L1.*sin(theta4)+(-1).*COM5y.*sin(theta5)+( ...
  -1).*y1.*sin(theta5)+(-1).*y2.*sin(theta5)+(-1).*y3.*sin(theta5))+m5.*( ...
  COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos(theta3+(-1).*theta4)+L1.*cos(theta4)) ...
  .*sin(theta5).*((-1).*cos(theta5).*(L1.*sin(theta2)+L1.*sin(theta2+(-1) ...
  .*theta3)+(COM5z+(-2).*L1+z0+z2+z3+z4).*sin(theta2+(-1).*theta3+theta4)) ...
  +cos(theta2+(-1).*theta3+theta4).*(COM5x+y4.*sin(theta5)))+(-1).*m5.*( ...
  COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos(theta3+(-1).*theta4)+L1.*cos(theta4)) ...
  .*cos(theta5).*((-1).*(cos(theta2+(-1).*theta3+theta4).*cos(theta5).* ...
  sin(theta1)+cos(theta1).*sin(theta5)).*(sin(theta1).*(y4+(COM5y+y1+y2+ ...
  y3).*cos(theta5)+COM5x.*sin(theta5))+(-1).*cos(theta1).*((-1).*L1.*(sin( ...
  theta2)+sin(theta2+(-1).*theta3))+(-1).*(COM5z+(-2).*L1+z0+z2+z3+z4).* ...
  sin(theta2+(-1).*theta3+theta4)+cos(theta2+(-1).*theta3+theta4).*( ...
  COM5x.*cos(theta5)+(-1).*(COM5y+y1+y2+y3).*sin(theta5))))+(-1).*(cos( ...
  theta1).*cos(theta2+(-1).*theta3+theta4).*cos(theta5)+(-1).*sin(theta1) ...
  .*sin(theta5)).*(cos(theta1).*(y4+(COM5y+y1+y2+y3).*cos(theta5)+COM5x.* ...
  sin(theta5))+sin(theta1).*((-1).*L1.*(sin(theta2)+sin(theta2+(-1).* ...
  theta3))+(-1).*(COM5z+(-2).*L1+z0+z2+z3+z4).*sin(theta2+(-1).*theta3+ ...
  theta4)+cos(theta2+(-1).*theta3+theta4).*(COM5x.*cos(theta5)+(-1).*( ...
  COM5y+y1+y2+y3).*sin(theta5))))),Iyy2+Iyy3+Iyy4+COM2x.^2.*m2+m2.*((-1).* ...
  COM2z+(-1).*z0).^2+m3.*((-1).*COM3z+L1+(-1).*z0+(-1).*z2+(-1).*L1.*cos( ...
  theta3)).^2+m4.*((-1).*COM4z+2.*L1+(-1).*z0+(-1).*z2+(-1).*z3+(-1).*L1.* ...
  cos(theta3+(-1).*theta4)+(-1).*L1.*cos(theta4)).^2+m5.*(COM5z+(-2).*L1+ ...
  z0+z2+z3+z4+L1.*cos(theta3+(-1).*theta4)+L1.*cos(theta4)).^2.*cos( ...
  theta5).^2+m3.*(COM3x+(-1).*L1.*sin(theta3)).^2+m4.*(COM4x+(-1).*L1.* ...
  sin(theta3+(-1).*theta4)+L1.*sin(theta4)).^2+m5.*(COM5z+(-2).*L1+z0+z2+ ...
  z3+z4+L1.*cos(theta3+(-1).*theta4)+L1.*cos(theta4)).^2.*sin(theta5).^2+( ...
  -1).*sin(theta5).*((-1).*Ixy5.*cos(theta5)+(-1).*Ixx5.*sin(theta5))+(-1) ...
  .*cos(theta5).*((-1).*Iyy5.*cos(theta5)+(-1).*Ixy5.*sin(theta5))+m5.*( ...
  COM5x.*cos(theta5)+(-1).*L1.*sin(theta3+(-1).*theta4)+L1.*sin(theta4)+( ...
  -1).*COM5y.*sin(theta5)+(-1).*y1.*sin(theta5)+(-1).*y2.*sin(theta5)+(-1) ...
  .*y3.*sin(theta5)).^2,(-1).*Iyy3+(-1).*Iyy4+m3.*(COM3z+(-1).*L1+z0+z2).* ...
  ((-1).*COM3z+L1+(-1).*z0+(-1).*z2+(-1).*L1.*cos(theta3))+m4.*((-1).* ...
  COM4z+2.*L1+(-1).*z0+(-1).*z2+(-1).*z3+(-1).*L1.*cos(theta3+(-1).* ...
  theta4)+(-1).*L1.*cos(theta4)).*(COM4z+(-2).*L1+z0+z2+z3+L1.*cos(theta4) ...
  )+(-1).*m5.*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos(theta4)).*(COM5z+(-2).* ...
  L1+z0+z2+z3+z4+L1.*cos(theta3+(-1).*theta4)+L1.*cos(theta4)).*cos( ...
  theta5).^2+(-1).*COM3x.*m3.*(COM3x+(-1).*L1.*sin(theta3))+m4.*((-1).* ...
  COM4x+(-1).*L1.*sin(theta4)).*(COM4x+(-1).*L1.*sin(theta3+(-1).*theta4)+ ...
  L1.*sin(theta4))+(-1).*m5.*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos(theta4)) ...
  .*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos(theta3+(-1).*theta4)+L1.*cos( ...
  theta4)).*sin(theta5).^2+sin(theta5).*((-1).*Ixy5.*cos(theta5)+(-1).* ...
  Ixx5.*sin(theta5))+cos(theta5).*((-1).*Iyy5.*cos(theta5)+(-1).*Ixy5.* ...
  sin(theta5))+m5.*(COM5x.*cos(theta5)+(-1).*L1.*sin(theta3+(-1).*theta4)+ ...
  L1.*sin(theta4)+(-1).*COM5y.*sin(theta5)+(-1).*y1.*sin(theta5)+(-1).* ...
  y2.*sin(theta5)+(-1).*y3.*sin(theta5)).*((-1).*COM5x.*cos(theta5)+(-1).* ...
  L1.*sin(theta4)+(COM5y+y1+y2+y3).*sin(theta5)),Iyy4+m4.*((-1).*COM4z+2.* ...
  L1+(-1).*z0+(-1).*z2+(-1).*z3).*((-1).*COM4z+2.*L1+(-1).*z0+(-1).*z2+( ...
  -1).*z3+(-1).*L1.*cos(theta3+(-1).*theta4)+(-1).*L1.*cos(theta4))+m5.*( ...
  COM5z+(-2).*L1+z0+z2+z3+z4).*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos(theta3+ ...
  (-1).*theta4)+L1.*cos(theta4)).*cos(theta5).^2+COM4x.*m4.*(COM4x+(-1).* ...
  L1.*sin(theta3+(-1).*theta4)+L1.*sin(theta4))+m5.*(COM5z+(-2).*L1+z0+z2+ ...
  z3+z4).*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos(theta3+(-1).*theta4)+L1.* ...
  cos(theta4)).*sin(theta5).^2+(-1).*sin(theta5).*((-1).*Ixy5.*cos(theta5)+...
  (-1).*Ixx5.*sin(theta5))+(-1).*cos(theta5).*((-1).*Iyy5.*cos(theta5)+( ...
  -1).*Ixy5.*sin(theta5))+m5.*(COM5x.*cos(theta5)+(-1).*L1.*sin(theta3+( ...
  -1).*theta4)+L1.*sin(theta4)+(-1).*COM5y.*sin(theta5)+(-1).*y1.*sin( ...
  theta5)+(-1).*y2.*sin(theta5)+(-1).*y3.*sin(theta5)).*(COM5x.*cos( ...
  theta5)+(-1).*(COM5y+y1+y2+y3).*sin(theta5)),(-1).*Iyz5.*cos(theta5)+( ...
  -1).*m5.*((-1).*COM5y+(-1).*y1+(-1).*y2+(-1).*y3).*(COM5z+(-2).*L1+z0+ ...
  z2+z3+z4+L1.*cos(theta3+(-1).*theta4)+L1.*cos(theta4)).*cos(theta5)+(-1) ...
  .*Ixz5.*sin(theta5)+COM5x.*m5.*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos( ...
  theta3+(-1).*theta4)+L1.*cos(theta4)).*sin(theta5);...
  Iyz3.*cos(theta2+(-1) ...
  .*theta3)+(-1).*m3.*(COM3y+y1+y2).*(COM3z+(-1).*L1+z0+z2).*cos(theta2+( ...
  -1).*theta3)+Iyz4.*cos(theta2+(-1).*theta3+theta4)+(-1).*m4.*(COM4y+y1+ ...
  y2+y3).*(COM4z+(-2).*L1+z0+z2+z3+L1.*cos(theta4)).*cos(theta2+(-1).* ...
  theta3+theta4)+Ixy3.*sin(theta2+(-1).*theta3)+(-1).*COM3x.*m3.*(COM3y+ ...
  y1+y2).*sin(theta2+(-1).*theta3)+Ixy4.*sin(theta2+(-1).*theta3+theta4)+ ...
  m4.*(COM4y+y1+y2+y3).*((-1).*COM4x+(-1).*L1.*sin(theta4)).*sin(theta2+( ...
  -1).*theta3+theta4)+cos(theta5).*sin(theta2+(-1).*theta3+theta4).*( ...
  Ixy5.*cos(theta5)+Ixx5.*sin(theta5))+(-1).*sin(theta2+(-1).*theta3+ ...
  theta4).*sin(theta5).*(Iyy5.*cos(theta5)+Ixy5.*sin(theta5))+cos(theta2+( ...
  -1).*theta3+theta4).*(Iyz5.*cos(theta5)+Ixz5.*sin(theta5))+m5.*sin( ...
  theta2+(-1).*theta3+theta4).*(y4+(COM5y+y1+y2+y3).*cos(theta5)+COM5x.* ...
  sin(theta5)).*((-1).*COM5x.*cos(theta5)+(-1).*L1.*sin(theta4)+(COM5y+y1+ ...
  y2+y3).*sin(theta5))+(-1).*m5.*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos( ...
  theta4)).*sin(theta5).*((-1).*cos(theta5).*(L1.*sin(theta2)+L1.*sin( ...
  theta2+(-1).*theta3)+(COM5z+(-2).*L1+z0+z2+z3+z4).*sin(theta2+(-1).* ...
  theta3+theta4))+cos(theta2+(-1).*theta3+theta4).*(COM5x+y4.*sin(theta5)) ...
  )+m5.*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos(theta4)).*cos(theta5).*((-1).* ...
  (cos(theta2+(-1).*theta3+theta4).*cos(theta5).*sin(theta1)+cos(theta1).* ...
  sin(theta5)).*(sin(theta1).*(y4+(COM5y+y1+y2+y3).*cos(theta5)+COM5x.* ...
  sin(theta5))+(-1).*cos(theta1).*((-1).*L1.*(sin(theta2)+sin(theta2+(-1) ...
  .*theta3))+(-1).*(COM5z+(-2).*L1+z0+z2+z3+z4).*sin(theta2+(-1).*theta3+ ...
  theta4)+cos(theta2+(-1).*theta3+theta4).*(COM5x.*cos(theta5)+(-1).*( ...
  COM5y+y1+y2+y3).*sin(theta5))))+(-1).*(cos(theta1).*cos(theta2+(-1).* ...
  theta3+theta4).*cos(theta5)+(-1).*sin(theta1).*sin(theta5)).*(cos( ...
  theta1).*(y4+(COM5y+y1+y2+y3).*cos(theta5)+COM5x.*sin(theta5))+sin( ...
  theta1).*((-1).*L1.*(sin(theta2)+sin(theta2+(-1).*theta3))+(-1).*(COM5z+ ...
  (-2).*L1+z0+z2+z3+z4).*sin(theta2+(-1).*theta3+theta4)+cos(theta2+(-1).* ...
  theta3+theta4).*(COM5x.*cos(theta5)+(-1).*(COM5y+y1+y2+y3).*sin(theta5)) ...
  ))),(-1).*Iyy3+(-1).*Iyy4+m3.*(COM3z+(-1).*L1+z0+z2).*((-1).*COM3z+L1+( ...
  -1).*z0+(-1).*z2+(-1).*L1.*cos(theta3))+m4.*((-1).*COM4z+2.*L1+(-1).*z0+ ...
  (-1).*z2+(-1).*z3+(-1).*L1.*cos(theta3+(-1).*theta4)+(-1).*L1.*cos( ...
  theta4)).*(COM4z+(-2).*L1+z0+z2+z3+L1.*cos(theta4))+(-1).*m5.*(COM5z+( ...
  -2).*L1+z0+z2+z3+z4+L1.*cos(theta4)).*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.* ...
  cos(theta3+(-1).*theta4)+L1.*cos(theta4)).*cos(theta5).^2+(-1).*COM3x.* ...
  m3.*(COM3x+(-1).*L1.*sin(theta3))+m4.*((-1).*COM4x+(-1).*L1.*sin(theta4) ...
  ).*(COM4x+(-1).*L1.*sin(theta3+(-1).*theta4)+L1.*sin(theta4))+(-1).*m5.* ...
  (COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos(theta4)).*(COM5z+(-2).*L1+z0+z2+z3+ ...
  z4+L1.*cos(theta3+(-1).*theta4)+L1.*cos(theta4)).*sin(theta5).^2+(-1).* ...
  sin(theta5).*(Ixy5.*cos(theta5)+Ixx5.*sin(theta5))+(-1).*cos(theta5).*( ...
  Iyy5.*cos(theta5)+Ixy5.*sin(theta5))+m5.*(COM5x.*cos(theta5)+(-1).*L1.* ...
  sin(theta3+(-1).*theta4)+L1.*sin(theta4)+(-1).*COM5y.*sin(theta5)+(-1).* ...
  y1.*sin(theta5)+(-1).*y2.*sin(theta5)+(-1).*y3.*sin(theta5)).*((-1).* ...
  COM5x.*cos(theta5)+(-1).*L1.*sin(theta4)+(COM5y+y1+y2+y3).*sin(theta5)), ...
  Iyy3+Iyy4+COM3x.^2.*m3+m3.*(COM3z+(-1).*L1+z0+z2).^2+m4.*(COM4z+(-2).* ...
  L1+z0+z2+z3+L1.*cos(theta4)).^2+m5.*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos( ...
  theta4)).^2.*cos(theta5).^2+m4.*((-1).*COM4x+(-1).*L1.*sin(theta4)).^2+ ...
  m5.*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos(theta4)).^2.*sin(theta5).^2+sin( ...
  theta5).*(Ixy5.*cos(theta5)+Ixx5.*sin(theta5))+cos(theta5).*(Iyy5.*cos( ...
  theta5)+Ixy5.*sin(theta5))+m5.*((-1).*COM5x.*cos(theta5)+(-1).*L1.*sin( ...
  theta4)+(COM5y+y1+y2+y3).*sin(theta5)).^2,(-1).*Iyy4+m4.*((-1).*COM4z+ ...
  2.*L1+(-1).*z0+(-1).*z2+(-1).*z3).*(COM4z+(-2).*L1+z0+z2+z3+L1.*cos( ...
  theta4))+(-1).*m5.*(COM5z+(-2).*L1+z0+z2+z3+z4).*(COM5z+(-2).*L1+z0+z2+ ...
  z3+z4+L1.*cos(theta4)).*cos(theta5).^2+COM4x.*m4.*((-1).*COM4x+(-1).* ...
  L1.*sin(theta4))+(-1).*m5.*(COM5z+(-2).*L1+z0+z2+z3+z4).*(COM5z+(-2).* ...
  L1+z0+z2+z3+z4+L1.*cos(theta4)).*sin(theta5).^2+(-1).*sin(theta5).*( ...
  Ixy5.*cos(theta5)+Ixx5.*sin(theta5))+(-1).*cos(theta5).*(Iyy5.*cos( ...
  theta5)+Ixy5.*sin(theta5))+m5.*(COM5x.*cos(theta5)+(-1).*(COM5y+y1+y2+ ...
  y3).*sin(theta5)).*((-1).*COM5x.*cos(theta5)+(-1).*L1.*sin(theta4)+( ...
  COM5y+y1+y2+y3).*sin(theta5)),Iyz5.*cos(theta5)+m5.*((-1).*COM5y+(-1).* ...
  y1+(-1).*y2+(-1).*y3).*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos(theta4)).* ...
  cos(theta5)+Ixz5.*sin(theta5)+(-1).*COM5x.*m5.*(COM5z+(-2).*L1+z0+z2+z3+ ...
  z4+L1.*cos(theta4)).*sin(theta5);...
  (-1).*Iyz4.*cos(theta2+(-1).*theta3+ ...
  theta4)+(-1).*m4.*(COM4y+y1+y2+y3).*((-1).*COM4z+2.*L1+(-1).*z0+(-1).* ...
  z2+(-1).*z3).*cos(theta2+(-1).*theta3+theta4)+(-1).*Ixy4.*sin(theta2+( ...
  -1).*theta3+theta4)+COM4x.*m4.*(COM4y+y1+y2+y3).*sin(theta2+(-1).* ...
  theta3+theta4)+cos(theta5).*sin(theta2+(-1).*theta3+theta4).*((-1).* ...
  Ixy5.*cos(theta5)+(-1).*Ixx5.*sin(theta5))+(-1).*sin(theta2+(-1).* ...
  theta3+theta4).*sin(theta5).*((-1).*Iyy5.*cos(theta5)+(-1).*Ixy5.*sin( ...
  theta5))+cos(theta2+(-1).*theta3+theta4).*((-1).*Iyz5.*cos(theta5)+(-1) ...
  .*Ixz5.*sin(theta5))+m5.*sin(theta2+(-1).*theta3+theta4).*(y4+(COM5y+y1+ ...
  y2+y3).*cos(theta5)+COM5x.*sin(theta5)).*(COM5x.*cos(theta5)+(-1).*( ...
  COM5y+y1+y2+y3).*sin(theta5))+m5.*(COM5z+(-2).*L1+z0+z2+z3+z4).*sin( ...
  theta5).*((-1).*cos(theta5).*(L1.*sin(theta2)+L1.*sin(theta2+(-1).* ...
  theta3)+(COM5z+(-2).*L1+z0+z2+z3+z4).*sin(theta2+(-1).*theta3+theta4))+ ...
  cos(theta2+(-1).*theta3+theta4).*(COM5x+y4.*sin(theta5)))+(-1).*m5.*( ...
  COM5z+(-2).*L1+z0+z2+z3+z4).*cos(theta5).*((-1).*(cos(theta2+(-1).* ...
  theta3+theta4).*cos(theta5).*sin(theta1)+cos(theta1).*sin(theta5)).*( ...
  sin(theta1).*(y4+(COM5y+y1+y2+y3).*cos(theta5)+COM5x.*sin(theta5))+(-1) ...
  .*cos(theta1).*((-1).*L1.*(sin(theta2)+sin(theta2+(-1).*theta3))+(-1).*( ...
  COM5z+(-2).*L1+z0+z2+z3+z4).*sin(theta2+(-1).*theta3+theta4)+cos(theta2+ ...
  (-1).*theta3+theta4).*(COM5x.*cos(theta5)+(-1).*(COM5y+y1+y2+y3).*sin( ...
  theta5))))+(-1).*(cos(theta1).*cos(theta2+(-1).*theta3+theta4).*cos( ...
  theta5)+(-1).*sin(theta1).*sin(theta5)).*(cos(theta1).*(y4+(COM5y+y1+y2+ ...
  y3).*cos(theta5)+COM5x.*sin(theta5))+sin(theta1).*((-1).*L1.*(sin( ...
  theta2)+sin(theta2+(-1).*theta3))+(-1).*(COM5z+(-2).*L1+z0+z2+z3+z4).* ...
  sin(theta2+(-1).*theta3+theta4)+cos(theta2+(-1).*theta3+theta4).*( ...
  COM5x.*cos(theta5)+(-1).*(COM5y+y1+y2+y3).*sin(theta5))))),Iyy4+m4.*(( ...
  -1).*COM4z+2.*L1+(-1).*z0+(-1).*z2+(-1).*z3).*((-1).*COM4z+2.*L1+(-1).* ...
  z0+(-1).*z2+(-1).*z3+(-1).*L1.*cos(theta3+(-1).*theta4)+(-1).*L1.*cos( ...
  theta4))+m5.*(COM5z+(-2).*L1+z0+z2+z3+z4).*(COM5z+(-2).*L1+z0+z2+z3+z4+ ...
  L1.*cos(theta3+(-1).*theta4)+L1.*cos(theta4)).*cos(theta5).^2+COM4x.* ...
  m4.*(COM4x+(-1).*L1.*sin(theta3+(-1).*theta4)+L1.*sin(theta4))+m5.*( ...
  COM5z+(-2).*L1+z0+z2+z3+z4).*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos(theta3+ ...
  (-1).*theta4)+L1.*cos(theta4)).*sin(theta5).^2+(-1).*sin(theta5).*((-1) ...
  .*Ixy5.*cos(theta5)+(-1).*Ixx5.*sin(theta5))+(-1).*cos(theta5).*((-1).* ...
  Iyy5.*cos(theta5)+(-1).*Ixy5.*sin(theta5))+m5.*(COM5x.*cos(theta5)+(-1) ...
  .*L1.*sin(theta3+(-1).*theta4)+L1.*sin(theta4)+(-1).*COM5y.*sin(theta5)+ ...
  (-1).*y1.*sin(theta5)+(-1).*y2.*sin(theta5)+(-1).*y3.*sin(theta5)).*( ...
  COM5x.*cos(theta5)+(-1).*(COM5y+y1+y2+y3).*sin(theta5)),(-1).*Iyy4+m4.*( ...
  (-1).*COM4z+2.*L1+(-1).*z0+(-1).*z2+(-1).*z3).*(COM4z+(-2).*L1+z0+z2+z3+ ...
  L1.*cos(theta4))+(-1).*m5.*(COM5z+(-2).*L1+z0+z2+z3+z4).*(COM5z+(-2).* ...
  L1+z0+z2+z3+z4+L1.*cos(theta4)).*cos(theta5).^2+COM4x.*m4.*((-1).*COM4x+ ...
  (-1).*L1.*sin(theta4))+(-1).*m5.*(COM5z+(-2).*L1+z0+z2+z3+z4).*(COM5z+( ...
  -2).*L1+z0+z2+z3+z4+L1.*cos(theta4)).*sin(theta5).^2+sin(theta5).*((-1) ...
  .*Ixy5.*cos(theta5)+(-1).*Ixx5.*sin(theta5))+cos(theta5).*((-1).*Iyy5.* ...
  cos(theta5)+(-1).*Ixy5.*sin(theta5))+m5.*(COM5x.*cos(theta5)+(-1).*( ...
  COM5y+y1+y2+y3).*sin(theta5)).*((-1).*COM5x.*cos(theta5)+(-1).*L1.*sin( ...
  theta4)+(COM5y+y1+y2+y3).*sin(theta5)),Iyy4+COM4x.^2.*m4+m4.*((-1).* ...
  COM4z+2.*L1+(-1).*z0+(-1).*z2+(-1).*z3).^2+m5.*(COM5z+(-2).*L1+z0+z2+z3+ ...
  z4).^2.*cos(theta5).^2+m5.*(COM5z+(-2).*L1+z0+z2+z3+z4).^2.*sin(theta5) ...
  .^2+(-1).*sin(theta5).*((-1).*Ixy5.*cos(theta5)+(-1).*Ixx5.*sin(theta5))+...
  (-1).*cos(theta5).*((-1).*Iyy5.*cos(theta5)+(-1).*Ixy5.*sin(theta5))+ ...
  m5.*(COM5x.*cos(theta5)+(-1).*(COM5y+y1+y2+y3).*sin(theta5)).^2,(-1).* ...
  Iyz5.*cos(theta5)+(-1).*m5.*((-1).*COM5y+(-1).*y1+(-1).*y2+(-1).*y3).*( ...
  COM5z+(-2).*L1+z0+z2+z3+z4).*cos(theta5)+(-1).*Ixz5.*sin(theta5)+COM5x.* ...
  m5.*(COM5z+(-2).*L1+z0+z2+z3+z4).*sin(theta5);...
  Izz5.*cos(theta2+(-1).* ...
  theta3+theta4)+Ixz5.*cos(theta5).*sin(theta2+(-1).*theta3+theta4)+(-1).* ...
  Iyz5.*sin(theta2+(-1).*theta3+theta4).*sin(theta5)+COM5x.*m5.*((-1).* ...
  cos(theta5).*(L1.*sin(theta2)+L1.*sin(theta2+(-1).*theta3)+(COM5z+(-2).* ...
  L1+z0+z2+z3+z4).*sin(theta2+(-1).*theta3+theta4))+cos(theta2+(-1).* ...
  theta3+theta4).*(COM5x+y4.*sin(theta5)))+m5.*((-1).*COM5y+(-1).*y1+(-1) ...
  .*y2+(-1).*y3).*((-1).*(cos(theta2+(-1).*theta3+theta4).*cos(theta5).* ...
  sin(theta1)+cos(theta1).*sin(theta5)).*(sin(theta1).*(y4+(COM5y+y1+y2+ ...
  y3).*cos(theta5)+COM5x.*sin(theta5))+(-1).*cos(theta1).*((-1).*L1.*(sin( ...
  theta2)+sin(theta2+(-1).*theta3))+(-1).*(COM5z+(-2).*L1+z0+z2+z3+z4).* ...
  sin(theta2+(-1).*theta3+theta4)+cos(theta2+(-1).*theta3+theta4).*( ...
  COM5x.*cos(theta5)+(-1).*(COM5y+y1+y2+y3).*sin(theta5))))+(-1).*(cos( ...
  theta1).*cos(theta2+(-1).*theta3+theta4).*cos(theta5)+(-1).*sin(theta1) ...
  .*sin(theta5)).*(cos(theta1).*(y4+(COM5y+y1+y2+y3).*cos(theta5)+COM5x.* ...
  sin(theta5))+sin(theta1).*((-1).*L1.*(sin(theta2)+sin(theta2+(-1).* ...
  theta3))+(-1).*(COM5z+(-2).*L1+z0+z2+z3+z4).*sin(theta2+(-1).*theta3+ ...
  theta4)+cos(theta2+(-1).*theta3+theta4).*(COM5x.*cos(theta5)+(-1).*( ...
  COM5y+y1+y2+y3).*sin(theta5))))),(-1).*Iyz5.*cos(theta5)+(-1).*m5.*((-1) ...
  .*COM5y+(-1).*y1+(-1).*y2+(-1).*y3).*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.* ...
  cos(theta3+(-1).*theta4)+L1.*cos(theta4)).*cos(theta5)+(-1).*Ixz5.*sin( ...
  theta5)+COM5x.*m5.*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos(theta3+(-1).* ...
  theta4)+L1.*cos(theta4)).*sin(theta5),Iyz5.*cos(theta5)+m5.*((-1).* ...
  COM5y+(-1).*y1+(-1).*y2+(-1).*y3).*(COM5z+(-2).*L1+z0+z2+z3+z4+L1.*cos( ...
  theta4)).*cos(theta5)+Ixz5.*sin(theta5)+(-1).*COM5x.*m5.*(COM5z+(-2).* ...
  L1+z0+z2+z3+z4+L1.*cos(theta4)).*sin(theta5),(-1).*Iyz5.*cos(theta5)+( ...
  -1).*m5.*((-1).*COM5y+(-1).*y1+(-1).*y2+(-1).*y3).*(COM5z+(-2).*L1+z0+ ...
  z2+z3+z4).*cos(theta5)+(-1).*Ixz5.*sin(theta5)+COM5x.*m5.*(COM5z+(-2).* ...
  L1+z0+z2+z3+z4).*sin(theta5),Izz5+COM5x.^2.*m5+m5.*((-1).*COM5y+(-1).* ...
  y1+(-1).*y2+(-1).*y3).^2];

